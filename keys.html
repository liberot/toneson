<html>
<meta charset="UTF-8"/>
<head>
<title></title>

<script type="text/javascript" src="./jquery.min.js"></script>

</head>

<body>

<div id="log"></div>

<script type="text/javascript">

var log = $('#log');

// http://pages.mtu.edu/~suits/notefreqs.html
var map = [];
	map[65] = { name: 'A', freq: 440 };
		map[87] = { name: 'A#/Bb', freq: 466.16 };
	
	map[83] = { name: 'B', freq: 493.88 };
	
	map[68] = { name: 'C', freq: 523.25 };
		map[82] = { name: 'C#/Db', freq: 554.37 };
	
	map[70] = { name: 'D', freq: 587.33 };
		map[84] = { name: 'D#/Eb', freq: 622.25 };
	
	map[71] = { name: 'E', freq: 659.25 };
	
	map[72] = { name: 'F', freq: 698.46 };
		map[85] = { name: 'F#/Gb', freq: 739.99 };
	
	map[74] = { name: 'G', freq: 783.99 };
		map[73] = { name: ' G#/Ab', freq: 830.61 };
	
	map[75] = { name: 'A', freq: 880.00 };
	
var keys = [];

var AudioContext = window.AudioContext || window.webkitAudioContext;
var audioCtx = new AudioContext();
var gain = audioCtx.createGain();
	gain.gain.setValueAtTime(1, audioCtx.currentTime);

var max = 3;

var osc = [];
for (var i = 0; i < max; i++){
	osc.push(audioCtx.createOscillator());
	// osc[i].type = 'sine';
	osc[i].connect(audioCtx.destination);
	osc[i].start();
};

$(document.body).keydown(function (evt) {
	if(-1 == keys.indexOf(evt.keyCode)){
    	keys.push(evt.keyCode);
    	keyChanged();
	}
});

$(document.body).keyup(function (evt) {
    keys.splice(keys.indexOf(evt.keyCode), 1);
   	keyChanged();
});

function keyChanged(){
   	play();
}

function play(){
	
	var l = '';
	for(var i in keys){
		if(i >= max){ continue };
		
		var m = map[keys[i]];
		console.log(keys[i]);

		if(null == m){ continue; }
		var t = parseInt(m.freq);		
		console.log(m.name, m.freq);

		l += m.name  +' '+m.freq +' | ';
	
		osc[i].frequency.setValueAtTime(t, audioCtx.currentTime);
		// osc[i].connect(audioCtx.destination);
		
		try {
			// osc[i].start();
		}
		catch(exc){
			// console.log(exc);
		}
	}

	log.text(l);
}



</script>

</body>

</html>

